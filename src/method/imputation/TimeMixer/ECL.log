nohup: ignoring input
Args in experiment:
Namespace(task_name='long_term_forecast', is_training=1, model_id='ECL_96_96', model='TimeMixer', data='custom', root_path='./dataset/electricity/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=0, pred_len=96, seasonal_patterns='Monthly', inverse=False, top_k=5, num_kernels=6, enc_in=321, dec_in=321, c_out=321, d_model=16, n_heads=8, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=3, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, channel_independence=1, decomp_method='moving_avg', use_norm=1, down_sampling_layers=3, down_sampling_window=2, down_sampling_method='avg', use_future_temporal_feature=0, mask_rate=0.125, anomaly_ratio=0.25, num_workers=10, itr=1, train_epochs=20, batch_size=32, patience=10, learning_rate=0.01, des='Exp', loss='MSE', drop_last=True, lradj='TST', pct_start=0.2, use_amp=False, comment='none', use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1', p_hidden_dims=[128, 128], p_hidden_layers=2)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_96_none_TimeMixer_custom_sl96_pl96_dm16_nh8_el3_dl1_df32_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18221
val 2537
test 5165
	iters: 100, epoch: 1 | loss: 0.3394333
	speed: 0.2367s/iter; left time: 2669.7125s
	iters: 200, epoch: 1 | loss: 0.2319404
	speed: 0.2421s/iter; left time: 2707.2977s
	iters: 300, epoch: 1 | loss: 0.2276620
	speed: 0.2528s/iter; left time: 2800.9752s
	iters: 400, epoch: 1 | loss: 0.2013070
	speed: 0.2426s/iter; left time: 2664.1070s
	iters: 500, epoch: 1 | loss: 0.1946979
	speed: 0.2591s/iter; left time: 2819.1253s
Epoch: 1 cost time: 138.7614004611969
Epoch: 1, Steps: 569 | Train Loss: 0.3023092 Vali Loss: 0.1689466 Test Loss: 0.1910244
Validation loss decreased (inf --> 0.168947).  Saving model ...
Updating learning rate to 0.001807059401889112
	iters: 100, epoch: 2 | loss: 0.1838445
	speed: 0.5853s/iter; left time: 6269.5169s
	iters: 200, epoch: 2 | loss: 0.1771779
	speed: 0.2075s/iter; left time: 2202.4444s
	iters: 300, epoch: 2 | loss: 0.1839406
	speed: 0.2243s/iter; left time: 2357.7450s
	iters: 400, epoch: 2 | loss: 0.1809061
	speed: 0.2243s/iter; left time: 2334.9411s
	iters: 500, epoch: 2 | loss: 0.1593646
	speed: 0.2217s/iter; left time: 2286.1389s
Epoch: 2 cost time: 125.27450633049011
Epoch: 2, Steps: 569 | Train Loss: 0.1827035 Vali Loss: 0.1553387 Test Loss: 0.1763232
Validation loss decreased (0.168947 --> 0.155339).  Saving model ...
Updating learning rate to 0.005203314207371222
	iters: 100, epoch: 3 | loss: 0.1684819
	speed: 0.5453s/iter; left time: 5530.5992s
	iters: 200, epoch: 3 | loss: 0.1638252
	speed: 0.1887s/iter; left time: 1895.3703s
	iters: 300, epoch: 3 | loss: 0.1978165
	speed: 0.1935s/iter; left time: 1923.8288s
	iters: 400, epoch: 3 | loss: 0.1635803
	speed: 0.2162s/iter; left time: 2128.2192s
	iters: 500, epoch: 3 | loss: 0.1783507
	speed: 0.2247s/iter; left time: 2189.4855s
Epoch: 3 cost time: 118.28964161872864
Epoch: 3, Steps: 569 | Train Loss: 0.1708639 Vali Loss: 0.1476420 Test Loss: 0.1693062
Validation loss decreased (0.155339 --> 0.147642).  Saving model ...
Updating learning rate to 0.008597625976752713
	iters: 100, epoch: 4 | loss: 0.1568897
	speed: 0.5509s/iter; left time: 5274.0477s
	iters: 200, epoch: 4 | loss: 0.1649212
	speed: 0.2095s/iter; left time: 1984.5483s
	iters: 300, epoch: 4 | loss: 0.1547142
	speed: 0.2077s/iter; left time: 1947.0855s
	iters: 400, epoch: 4 | loss: 0.1694439
	speed: 0.2005s/iter; left time: 1859.4811s
	iters: 500, epoch: 4 | loss: 0.1769883
	speed: 0.2176s/iter; left time: 1995.9489s
Epoch: 4 cost time: 119.66452169418335
Epoch: 4, Steps: 569 | Train Loss: 0.1651783 Vali Loss: 0.1438854 Test Loss: 0.1634747
Validation loss decreased (0.147642 --> 0.143885).  Saving model ...
Updating learning rate to 0.009999999702303647
	iters: 100, epoch: 5 | loss: 0.1465058
	speed: 0.5549s/iter; left time: 4997.2831s
	iters: 200, epoch: 5 | loss: 0.1867105
	speed: 0.2233s/iter; left time: 1988.2607s
	iters: 300, epoch: 5 | loss: 0.1813176
	speed: 0.2152s/iter; left time: 1895.0749s
	iters: 400, epoch: 5 | loss: 0.1774235
	speed: 0.2030s/iter; left time: 1767.2593s
	iters: 500, epoch: 5 | loss: 0.1455851
	speed: 0.2017s/iter; left time: 1735.8574s
Epoch: 5 cost time: 118.91795301437378
Epoch: 5, Steps: 569 | Train Loss: 0.1617728 Vali Loss: 0.1423054 Test Loss: 0.1619071
Validation loss decreased (0.143885 --> 0.142305).  Saving model ...
Updating learning rate to 0.009903589888524428
	iters: 100, epoch: 6 | loss: 0.1657562
	speed: 0.4667s/iter; left time: 3937.2909s
	iters: 200, epoch: 6 | loss: 0.1539536
	speed: 0.2167s/iter; left time: 1806.1094s
	iters: 300, epoch: 6 | loss: 0.1458310
	speed: 0.2179s/iter; left time: 1794.3566s
	iters: 400, epoch: 6 | loss: 0.1681315
	speed: 0.2198s/iter; left time: 1788.0771s
	iters: 500, epoch: 6 | loss: 0.1493537
	speed: 0.2196s/iter; left time: 1764.8485s
Epoch: 6 cost time: 121.44548034667969
Epoch: 6, Steps: 569 | Train Loss: 0.1597151 Vali Loss: 0.1385783 Test Loss: 0.1605404
Validation loss decreased (0.142305 --> 0.138578).  Saving model ...
Updating learning rate to 0.009618738633882892
	iters: 100, epoch: 7 | loss: 0.1571867
	speed: 0.5225s/iter; left time: 4110.1458s
	iters: 200, epoch: 7 | loss: 0.1556520
	speed: 0.2058s/iter; left time: 1598.4390s
	iters: 300, epoch: 7 | loss: 0.1662348
	speed: 0.1992s/iter; left time: 1527.2361s
	iters: 400, epoch: 7 | loss: 0.1741947
	speed: 0.2048s/iter; left time: 1549.8910s
	iters: 500, epoch: 7 | loss: 0.1538254
	speed: 0.2154s/iter; left time: 1608.7411s
Epoch: 7 cost time: 118.06987833976746
Epoch: 7, Steps: 569 | Train Loss: 0.1578058 Vali Loss: 0.1394685 Test Loss: 0.1600847
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.009156392612348487
	iters: 100, epoch: 8 | loss: 0.1566600
	speed: 0.5512s/iter; left time: 4022.4377s
	iters: 200, epoch: 8 | loss: 0.1727582
	speed: 0.2079s/iter; left time: 1496.3658s
	iters: 300, epoch: 8 | loss: 0.1619302
	speed: 0.1892s/iter; left time: 1343.1544s
	iters: 400, epoch: 8 | loss: 0.1683701
	speed: 0.1829s/iter; left time: 1280.1588s
	iters: 500, epoch: 8 | loss: 0.1467474
	speed: 0.1832s/iter; left time: 1263.9916s
Epoch: 8 cost time: 110.67408275604248
Epoch: 8, Steps: 569 | Train Loss: 0.1566035 Vali Loss: 0.1383825 Test Loss: 0.1597703
Validation loss decreased (0.138578 --> 0.138382).  Saving model ...
Updating learning rate to 0.008534319522242146
	iters: 100, epoch: 9 | loss: 0.1719459
	speed: 0.4616s/iter; left time: 3106.0374s
	iters: 200, epoch: 9 | loss: 0.1639534
	speed: 0.1939s/iter; left time: 1285.5521s
	iters: 300, epoch: 9 | loss: 0.1575679
	speed: 0.1861s/iter; left time: 1214.7411s
	iters: 400, epoch: 9 | loss: 0.1752092
	speed: 0.1899s/iter; left time: 1220.7191s
	iters: 500, epoch: 9 | loss: 0.1470095
	speed: 0.1907s/iter; left time: 1207.1884s
Epoch: 9 cost time: 107.00408101081848
Epoch: 9, Steps: 569 | Train Loss: 0.1555683 Vali Loss: 0.1372747 Test Loss: 0.1588417
Validation loss decreased (0.138382 --> 0.137275).  Saving model ...
Updating learning rate to 0.007776425283554044
	iters: 100, epoch: 10 | loss: 0.1447030
	speed: 0.4653s/iter; left time: 2866.2965s
	iters: 200, epoch: 10 | loss: 0.1413284
	speed: 0.1946s/iter; left time: 1179.0690s
	iters: 300, epoch: 10 | loss: 0.1356836
	speed: 0.1937s/iter; left time: 1154.3692s
	iters: 400, epoch: 10 | loss: 0.1478392
	speed: 0.1787s/iter; left time: 1046.9380s
	iters: 500, epoch: 10 | loss: 0.1429729
	speed: 0.1844s/iter; left time: 1062.3398s
Epoch: 10 cost time: 106.33551716804504
Epoch: 10, Steps: 569 | Train Loss: 0.1544257 Vali Loss: 0.1360778 Test Loss: 0.1591026
Validation loss decreased (0.137275 --> 0.136078).  Saving model ...
Updating learning rate to 0.0069118353468449805
	iters: 100, epoch: 11 | loss: 0.1635312
	speed: 0.4728s/iter; left time: 2643.6432s
	iters: 200, epoch: 11 | loss: 0.1412541
	speed: 0.1834s/iter; left time: 1006.7924s
	iters: 300, epoch: 11 | loss: 0.1549479
	speed: 0.1838s/iter; left time: 991.0631s
	iters: 400, epoch: 11 | loss: 0.1416575
	speed: 0.1928s/iter; left time: 1019.8628s
	iters: 500, epoch: 11 | loss: 0.1266543
	speed: 0.1870s/iter; left time: 970.5621s
Epoch: 11 cost time: 106.200847864151
Epoch: 11, Steps: 569 | Train Loss: 0.1533541 Vali Loss: 0.1341402 Test Loss: 0.1565916
Validation loss decreased (0.136078 --> 0.134140).  Saving model ...
Updating learning rate to 0.005973775418515064
	iters: 100, epoch: 12 | loss: 0.1529368
	speed: 0.4811s/iter; left time: 2416.3161s
	iters: 200, epoch: 12 | loss: 0.1734974
	speed: 0.1957s/iter; left time: 963.3875s
	iters: 300, epoch: 12 | loss: 0.1510465
	speed: 0.1889s/iter; left time: 910.9603s
	iters: 400, epoch: 12 | loss: 0.1440505
	speed: 0.1841s/iter; left time: 869.3093s
	iters: 500, epoch: 12 | loss: 0.1432080
	speed: 0.1841s/iter; left time: 850.7513s
Epoch: 12 cost time: 107.49451851844788
Epoch: 12, Steps: 569 | Train Loss: 0.1521282 Vali Loss: 0.1341624 Test Loss: 0.1580838
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.004998294615539945
	iters: 100, epoch: 13 | loss: 0.1390319
	speed: 0.4087s/iter; left time: 1819.9787s
	iters: 200, epoch: 13 | loss: 0.1600830
	speed: 0.1293s/iter; left time: 562.7158s
	iters: 300, epoch: 13 | loss: 0.1316691
	speed: 0.1121s/iter; left time: 476.7686s
	iters: 400, epoch: 13 | loss: 0.1656743
	speed: 0.1293s/iter; left time: 537.1255s
	iters: 500, epoch: 13 | loss: 0.1490117
	speed: 0.1485s/iter; left time: 602.0539s
Epoch: 13 cost time: 74.83340239524841
Epoch: 13, Steps: 569 | Train Loss: 0.1509922 Vali Loss: 0.1334570 Test Loss: 0.1554826
Validation loss decreased (0.134140 --> 0.133457).  Saving model ...
Updating learning rate to 0.004022880118122018
	iters: 100, epoch: 14 | loss: 0.1457466
	speed: 0.3464s/iter; left time: 1345.4619s
	iters: 200, epoch: 14 | loss: 0.1623139
	speed: 0.1447s/iter; left time: 547.3987s
	iters: 300, epoch: 14 | loss: 0.1482468
	speed: 0.1517s/iter; left time: 558.7156s
	iters: 400, epoch: 14 | loss: 0.1407635
	speed: 0.1453s/iter; left time: 520.8457s
	iters: 500, epoch: 14 | loss: 0.1408646
	speed: 0.1456s/iter; left time: 507.1190s
Epoch: 14 cost time: 82.81525111198425
Epoch: 14, Steps: 569 | Train Loss: 0.1499503 Vali Loss: 0.1324199 Test Loss: 0.1542480
Validation loss decreased (0.133457 --> 0.132420).  Saving model ...
Updating learning rate to 0.003085016558378303
	iters: 100, epoch: 15 | loss: 0.1643464
	speed: 0.3756s/iter; left time: 1245.1277s
	iters: 200, epoch: 15 | loss: 0.1324456
	speed: 0.1424s/iter; left time: 457.9666s
	iters: 300, epoch: 15 | loss: 0.1506428
	speed: 0.1418s/iter; left time: 441.5691s
	iters: 400, epoch: 15 | loss: 0.1562948
	speed: 0.1486s/iter; left time: 447.9339s
	iters: 500, epoch: 15 | loss: 0.1474343
	speed: 0.1469s/iter; left time: 428.3158s
Epoch: 15 cost time: 82.24235773086548
Epoch: 15, Steps: 569 | Train Loss: 0.1487905 Vali Loss: 0.1311941 Test Loss: 0.1541224
Validation loss decreased (0.132420 --> 0.131194).  Saving model ...
Updating learning rate to 0.002220745506949808
	iters: 100, epoch: 16 | loss: 0.1815677
	speed: 0.3737s/iter; left time: 1026.2969s
	iters: 200, epoch: 16 | loss: 0.1670273
	speed: 0.1520s/iter; left time: 402.1603s
	iters: 300, epoch: 16 | loss: 0.1600371
	speed: 0.1462s/iter; left time: 372.2986s
	iters: 400, epoch: 16 | loss: 0.1540717
	speed: 0.1425s/iter; left time: 348.4463s
	iters: 500, epoch: 16 | loss: 0.1420898
	speed: 0.1426s/iter; left time: 334.5407s
Epoch: 16 cost time: 83.50929713249207
Epoch: 16, Steps: 569 | Train Loss: 0.1477954 Vali Loss: 0.1307443 Test Loss: 0.1534035
Validation loss decreased (0.131194 --> 0.130744).  Saving model ...
Updating learning rate to 0.0014632804156541378
	iters: 100, epoch: 17 | loss: 0.1428063
	speed: 0.3649s/iter; left time: 794.3480s
	iters: 200, epoch: 17 | loss: 0.1468401
	speed: 0.1442s/iter; left time: 299.5904s
	iters: 300, epoch: 17 | loss: 0.1446973
	speed: 0.1451s/iter; left time: 286.8655s
	iters: 400, epoch: 17 | loss: 0.1479547
	speed: 0.1454s/iter; left time: 272.9240s
	iters: 500, epoch: 17 | loss: 0.1671417
	speed: 0.1488s/iter; left time: 264.4524s
Epoch: 17 cost time: 82.8458890914917
Epoch: 17, Steps: 569 | Train Loss: 0.1469368 Vali Loss: 0.1304080 Test Loss: 0.1531046
Validation loss decreased (0.130744 --> 0.130408).  Saving model ...
Updating learning rate to 0.0008417302431584706
	iters: 100, epoch: 18 | loss: 0.1431871
	speed: 0.3519s/iter; left time: 565.9055s
	iters: 200, epoch: 18 | loss: 0.1193861
	speed: 0.1432s/iter; left time: 215.8733s
	iters: 300, epoch: 18 | loss: 0.1609063
	speed: 0.1520s/iter; left time: 213.9620s
	iters: 400, epoch: 18 | loss: 0.1698395
	speed: 0.1516s/iter; left time: 198.3023s
	iters: 500, epoch: 18 | loss: 0.1443874
	speed: 0.1520s/iter; left time: 183.6235s
Epoch: 18 cost time: 83.7737979888916
Epoch: 18, Steps: 569 | Train Loss: 0.1462391 Vali Loss: 0.1300555 Test Loss: 0.1529727
Validation loss decreased (0.130408 --> 0.130056).  Saving model ...
Updating learning rate to 0.000379980814022461
	iters: 100, epoch: 19 | loss: 0.1552062
	speed: 0.3753s/iter; left time: 389.9469s
	iters: 200, epoch: 19 | loss: 0.1398664
	speed: 0.1364s/iter; left time: 128.1012s
	iters: 300, epoch: 19 | loss: 0.1361137
	speed: 0.1324s/iter; left time: 111.1063s
	iters: 400, epoch: 19 | loss: 0.1290453
	speed: 0.1481s/iter; left time: 109.4745s
	iters: 500, epoch: 19 | loss: 0.1332431
	speed: 0.1518s/iter; left time: 96.9790s
Epoch: 19 cost time: 81.80792260169983
Epoch: 19, Steps: 569 | Train Loss: 0.1457143 Vali Loss: 0.1298073 Test Loss: 0.1527622
Validation loss decreased (0.130056 --> 0.129807).  Saving model ...
Updating learning rate to 9.57768998557435e-05
	iters: 100, epoch: 20 | loss: 0.1389630
	speed: 0.3842s/iter; left time: 180.5967s
	iters: 200, epoch: 20 | loss: 0.1338276
	speed: 0.1518s/iter; left time: 56.1483s
	iters: 300, epoch: 20 | loss: 0.1450385
	speed: 0.1432s/iter; left time: 38.6581s
	iters: 400, epoch: 20 | loss: 0.1349880
	speed: 0.1206s/iter; left time: 20.5000s
	iters: 500, epoch: 20 | loss: 0.1621157
	speed: 0.1045s/iter; left time: 7.3133s
Epoch: 20 cost time: 75.39302468299866
Epoch: 20, Steps: 569 | Train Loss: 0.1454335 Vali Loss: 0.1298090 Test Loss: 0.1527524
EarlyStopping counter: 1 out of 10
Updating learning rate to 4.0297696353048286e-08
>>>>>>>testing : long_term_forecast_ECL_96_96_none_TimeMixer_custom_sl96_pl96_dm16_nh8_el3_dl1_df32_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5165
mse:0.15276247262954712, mae:0.2451510727405548
Args in experiment:
Namespace(task_name='long_term_forecast', is_training=1, model_id='ECL_96_192', model='TimeMixer', data='custom', root_path='./dataset/electricity/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=0, pred_len=192, seasonal_patterns='Monthly', inverse=False, top_k=5, num_kernels=6, enc_in=321, dec_in=321, c_out=321, d_model=16, n_heads=8, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=3, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, channel_independence=1, decomp_method='moving_avg', use_norm=1, down_sampling_layers=3, down_sampling_window=2, down_sampling_method='avg', use_future_temporal_feature=0, mask_rate=0.125, anomaly_ratio=0.25, num_workers=10, itr=1, train_epochs=20, batch_size=32, patience=10, learning_rate=0.01, des='Exp', loss='MSE', drop_last=True, lradj='TST', pct_start=0.2, use_amp=False, comment='none', use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1', p_hidden_dims=[128, 128], p_hidden_layers=2)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_192_none_TimeMixer_custom_sl96_pl192_dm16_nh8_el3_dl1_df32_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 18125
val 2441
test 5069
	iters: 100, epoch: 1 | loss: 0.3591196
	speed: 0.1760s/iter; left time: 1975.1631s
	iters: 200, epoch: 1 | loss: 0.2529127
	speed: 0.1617s/iter; left time: 1797.7657s
	iters: 300, epoch: 1 | loss: 0.2329941
	speed: 0.1579s/iter; left time: 1739.7118s
	iters: 400, epoch: 1 | loss: 0.2128907
	speed: 0.1530s/iter; left time: 1670.4264s
	iters: 500, epoch: 1 | loss: 0.1981752
	speed: 0.1517s/iter; left time: 1641.5768s
Epoch: 1 cost time: 89.5629551410675
Epoch: 1, Steps: 566 | Train Loss: 0.3201868 Vali Loss: 0.1753524 Test Loss: 0.2007233
Validation loss decreased (inf --> 0.175352).  Saving model ...
Updating learning rate to 0.0018070656174695183
	iters: 100, epoch: 2 | loss: 0.1923042
	speed: 0.3642s/iter; left time: 3880.2273s
	iters: 200, epoch: 2 | loss: 0.2114505
	speed: 0.1620s/iter; left time: 1710.4189s
	iters: 300, epoch: 2 | loss: 0.2282648
	speed: 0.1615s/iter; left time: 1688.1954s
	iters: 400, epoch: 2 | loss: 0.1964945
	speed: 0.1622s/iter; left time: 1679.8676s
	iters: 500, epoch: 2 | loss: 0.2005971
	speed: 0.1575s/iter; left time: 1614.8634s
Epoch: 2 cost time: 89.49250531196594
Epoch: 2, Steps: 566 | Train Loss: 0.1924823 Vali Loss: 0.1622590 Test Loss: 0.1868329
Validation loss decreased (0.175352 --> 0.162259).  Saving model ...
Updating learning rate to 0.005203331781601043
	iters: 100, epoch: 3 | loss: 0.1898830
	speed: 0.3600s/iter; left time: 3632.3158s
	iters: 200, epoch: 3 | loss: 0.1730841
	speed: 0.1516s/iter; left time: 1514.2978s
	iters: 300, epoch: 3 | loss: 0.1889460
	speed: 0.1592s/iter; left time: 1574.6700s
	iters: 400, epoch: 3 | loss: 0.1707307
	speed: 0.1544s/iter; left time: 1511.7238s
	iters: 500, epoch: 3 | loss: 0.1656082
	speed: 0.1546s/iter; left time: 1497.6823s
Epoch: 3 cost time: 86.78349661827087
Epoch: 3, Steps: 566 | Train Loss: 0.1825187 Vali Loss: 0.1561818 Test Loss: 0.1819053
Validation loss decreased (0.162259 --> 0.156182).  Saving model ...
Updating learning rate to 0.008597644597676007
	iters: 100, epoch: 4 | loss: 0.1962324
	speed: 0.3774s/iter; left time: 3593.5339s
	iters: 200, epoch: 4 | loss: 0.1543112
	speed: 0.1433s/iter; left time: 1349.9105s
	iters: 300, epoch: 4 | loss: 0.1677915
	speed: 0.1398s/iter; left time: 1303.4253s
	iters: 400, epoch: 4 | loss: 0.1596935
	speed: 0.1617s/iter; left time: 1490.9377s
	iters: 500, epoch: 4 | loss: 0.1909371
	speed: 0.1617s/iter; left time: 1475.3732s
Epoch: 4 cost time: 86.57227730751038
Epoch: 4, Steps: 566 | Train Loss: 0.1774830 Vali Loss: 0.1523990 Test Loss: 0.1748809
Validation loss decreased (0.156182 --> 0.152399).  Saving model ...
Updating learning rate to 0.009999999699139492
	iters: 100, epoch: 5 | loss: 0.1759231
	speed: 0.3864s/iter; left time: 3461.2504s
	iters: 200, epoch: 5 | loss: 0.1736860
	speed: 0.1623s/iter; left time: 1437.2859s
	iters: 300, epoch: 5 | loss: 0.1737611
	speed: 0.1438s/iter; left time: 1259.3329s
	iters: 400, epoch: 5 | loss: 0.1533509
	speed: 0.1399s/iter; left time: 1211.2470s
	iters: 500, epoch: 5 | loss: 0.1800565
	speed: 0.1523s/iter; left time: 1302.9164s
Epoch: 5 cost time: 86.78976273536682
Epoch: 5, Steps: 566 | Train Loss: 0.1748099 Vali Loss: 0.1502473 Test Loss: 0.1750470
Validation loss decreased (0.152399 --> 0.150247).  Saving model ...
Updating learning rate to 0.00990358810129141
	iters: 100, epoch: 6 | loss: 0.1711805
	speed: 0.3873s/iter; left time: 3249.6725s
	iters: 200, epoch: 6 | loss: 0.1762864
	speed: 0.1620s/iter; left time: 1342.8484s
	iters: 300, epoch: 6 | loss: 0.1858649
	speed: 0.1619s/iter; left time: 1326.1608s
	iters: 400, epoch: 6 | loss: 0.1686431
	speed: 0.1545s/iter; left time: 1250.4323s
	iters: 500, epoch: 6 | loss: 0.1885051
	speed: 0.1335s/iter; left time: 1066.8412s
Epoch: 6 cost time: 86.88791346549988
Epoch: 6, Steps: 566 | Train Loss: 0.1728668 Vali Loss: 0.1506352 Test Loss: 0.1761279
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.009618735131263371
	iters: 100, epoch: 7 | loss: 0.1622261
	speed: 0.3585s/iter; left time: 2804.9838s
	iters: 200, epoch: 7 | loss: 0.1736497
	speed: 0.1619s/iter; left time: 1250.2959s
	iters: 300, epoch: 7 | loss: 0.1694508
	speed: 0.1622s/iter; left time: 1237.1149s
	iters: 400, epoch: 7 | loss: 0.1733106
	speed: 0.1618s/iter; left time: 1217.7283s
	iters: 500, epoch: 7 | loss: 0.1693740
	speed: 0.1545s/iter; left time: 1147.0667s
Epoch: 7 cost time: 89.20470023155212
Epoch: 7, Steps: 566 | Train Loss: 0.1712093 Vali Loss: 0.1504975 Test Loss: 0.1724407
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.009156387528946167
	iters: 100, epoch: 8 | loss: 0.1466212
	speed: 0.3188s/iter; left time: 2314.2341s
	iters: 200, epoch: 8 | loss: 0.1638546
	speed: 0.1070s/iter; left time: 766.3165s
	iters: 300, epoch: 8 | loss: 0.1716323
	speed: 0.1132s/iter; left time: 799.2986s
	iters: 400, epoch: 8 | loss: 0.1742877
	speed: 0.1170s/iter; left time: 814.4686s
	iters: 500, epoch: 8 | loss: 0.1670751
	speed: 0.1173s/iter; left time: 804.8873s
Epoch: 8 cost time: 66.02428317070007
Epoch: 8, Steps: 566 | Train Loss: 0.1703196 Vali Loss: 0.1475534 Test Loss: 0.1723736
Validation loss decreased (0.150247 --> 0.147553).  Saving model ...
Updating learning rate to 0.008534313053409326
	iters: 100, epoch: 9 | loss: 0.2031904
	speed: 0.2843s/iter; left time: 1903.0024s
	iters: 200, epoch: 9 | loss: 0.1694831
	speed: 0.1126s/iter; left time: 742.5459s
	iters: 300, epoch: 9 | loss: 0.1601288
	speed: 0.1080s/iter; left time: 701.2140s
	iters: 400, epoch: 9 | loss: 0.1567896
	speed: 0.1074s/iter; left time: 686.9181s
	iters: 500, epoch: 9 | loss: 0.1621292
	speed: 0.1122s/iter; left time: 706.1307s
Epoch: 9 cost time: 63.553348541259766
Epoch: 9, Steps: 566 | Train Loss: 0.1689979 Vali Loss: 0.1453990 Test Loss: 0.1699877
Validation loss decreased (0.147553 --> 0.145399).  Saving model ...
Updating learning rate to 0.007776417677884344
	iters: 100, epoch: 10 | loss: 0.1670888
	speed: 0.2773s/iter; left time: 1698.8168s
	iters: 200, epoch: 10 | loss: 0.1633034
	speed: 0.1110s/iter; left time: 668.8779s
	iters: 300, epoch: 10 | loss: 0.1654858
	speed: 0.1178s/iter; left time: 698.4166s
	iters: 400, epoch: 10 | loss: 0.1723405
	speed: 0.1126s/iter; left time: 655.9250s
	iters: 500, epoch: 10 | loss: 0.1627267
	speed: 0.1076s/iter; left time: 616.3484s
Epoch: 10 cost time: 63.11355209350586
Epoch: 10, Steps: 566 | Train Loss: 0.1679301 Vali Loss: 0.1455562 Test Loss: 0.1698364
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.006911826896620023
	iters: 100, epoch: 11 | loss: 0.1473732
	speed: 0.2721s/iter; left time: 1513.1491s
	iters: 200, epoch: 11 | loss: 0.1589932
	speed: 0.1174s/iter; left time: 640.8862s
	iters: 300, epoch: 11 | loss: 0.1760181
	speed: 0.1177s/iter; left time: 630.7567s
	iters: 400, epoch: 11 | loss: 0.1704746
	speed: 0.1175s/iter; left time: 618.1078s
	iters: 500, epoch: 11 | loss: 0.1529391
	speed: 0.1172s/iter; left time: 604.9140s
Epoch: 11 cost time: 66.41539525985718
Epoch: 11, Steps: 566 | Train Loss: 0.1668731 Vali Loss: 0.1471351 Test Loss: 0.1741322
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.005973766448472253
	iters: 100, epoch: 12 | loss: 0.1653327
	speed: 0.2675s/iter; left time: 1336.3544s
	iters: 200, epoch: 12 | loss: 0.1883127
	speed: 0.1075s/iter; left time: 526.2923s
	iters: 300, epoch: 12 | loss: 0.1666859
	speed: 0.1166s/iter; left time: 559.1560s
	iters: 400, epoch: 12 | loss: 0.1596222
	speed: 0.1173s/iter; left time: 550.6380s
	iters: 500, epoch: 12 | loss: 0.1667328
	speed: 0.1172s/iter; left time: 538.4931s
Epoch: 12 cost time: 64.43138551712036
Epoch: 12, Steps: 566 | Train Loss: 0.1657968 Vali Loss: 0.1458517 Test Loss: 0.1710043
EarlyStopping counter: 3 out of 10
Updating learning rate to 0.004998285470392995
	iters: 100, epoch: 13 | loss: 0.1707316
	speed: 0.2811s/iter; left time: 1245.0298s
	iters: 200, epoch: 13 | loss: 0.1583524
	speed: 0.1023s/iter; left time: 442.8055s
	iters: 300, epoch: 13 | loss: 0.1662574
	speed: 0.1019s/iter; left time: 430.9716s
	iters: 400, epoch: 13 | loss: 0.1819232
	speed: 0.1055s/iter; left time: 435.5552s
	iters: 500, epoch: 13 | loss: 0.1758634
	speed: 0.1161s/iter; left time: 467.7888s
Epoch: 13 cost time: 61.77788281440735
Epoch: 13, Steps: 566 | Train Loss: 0.1650204 Vali Loss: 0.1430277 Test Loss: 0.1683562
Validation loss decreased (0.145399 --> 0.143028).  Saving model ...
Updating learning rate to 0.004022871149313799
	iters: 100, epoch: 14 | loss: 0.1873736
	speed: 0.2862s/iter; left time: 1105.5558s
	iters: 200, epoch: 14 | loss: 0.1803274
	speed: 0.1172s/iter; left time: 441.0911s
	iters: 300, epoch: 14 | loss: 0.1578035
	speed: 0.1177s/iter; left time: 431.2916s
	iters: 400, epoch: 14 | loss: 0.1541025
	speed: 0.1092s/iter; left time: 389.0870s
	iters: 500, epoch: 14 | loss: 0.1742364
	speed: 0.1074s/iter; left time: 371.9964s
Epoch: 14 cost time: 64.0977635383606
Epoch: 14, Steps: 566 | Train Loss: 0.1637399 Vali Loss: 0.1431696 Test Loss: 0.1679841
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.003085008110575084
	iters: 100, epoch: 15 | loss: 0.1703497
	speed: 0.2756s/iter; left time: 908.7922s
	iters: 200, epoch: 15 | loss: 0.1628070
	speed: 0.1177s/iter; left time: 376.2293s
	iters: 300, epoch: 15 | loss: 0.1707499
	speed: 0.1176s/iter; left time: 364.3508s
	iters: 400, epoch: 15 | loss: 0.1861102
	speed: 0.1176s/iter; left time: 352.4340s
	iters: 500, epoch: 15 | loss: 0.1487334
	speed: 0.1172s/iter; left time: 339.5990s
Epoch: 15 cost time: 66.16614699363708
Epoch: 15, Steps: 566 | Train Loss: 0.1628231 Vali Loss: 0.1421198 Test Loss: 0.1680914
Validation loss decreased (0.143028 --> 0.142120).  Saving model ...
Updating learning rate to 0.0022207379047959287
	iters: 100, epoch: 16 | loss: 0.1605706
	speed: 0.2660s/iter; left time: 726.5550s
	iters: 200, epoch: 16 | loss: 0.1583533
	speed: 0.1096s/iter; left time: 288.2852s
	iters: 300, epoch: 16 | loss: 0.1528568
	speed: 0.1095s/iter; left time: 277.2169s
	iters: 400, epoch: 16 | loss: 0.1532039
	speed: 0.1106s/iter; left time: 268.7786s
	iters: 500, epoch: 16 | loss: 0.1797569
	speed: 0.1134s/iter; left time: 264.3977s
Epoch: 16 cost time: 62.886478424072266
Epoch: 16, Steps: 566 | Train Loss: 0.1618641 Vali Loss: 0.1414563 Test Loss: 0.1668117
Validation loss decreased (0.142120 --> 0.141456).  Saving model ...
Updating learning rate to 0.001463273951296111
	iters: 100, epoch: 17 | loss: 0.1634523
	speed: 0.2825s/iter; left time: 611.6727s
	iters: 200, epoch: 17 | loss: 0.1508938
	speed: 0.1077s/iter; left time: 222.3115s
	iters: 300, epoch: 17 | loss: 0.1615710
	speed: 0.1079s/iter; left time: 212.0319s
	iters: 400, epoch: 17 | loss: 0.1552690
	speed: 0.1106s/iter; left time: 206.3408s
	iters: 500, epoch: 17 | loss: 0.1895412
	speed: 0.1176s/iter; left time: 207.6098s
Epoch: 17 cost time: 63.716307163238525
Epoch: 17, Steps: 566 | Train Loss: 0.1612159 Vali Loss: 0.1411623 Test Loss: 0.1676929
Validation loss decreased (0.141456 --> 0.141162).  Saving model ...
Updating learning rate to 0.000841725165017947
	iters: 100, epoch: 18 | loss: 0.1800033
	speed: 0.2874s/iter; left time: 459.6068s
	iters: 200, epoch: 18 | loss: 0.1584112
	speed: 0.1178s/iter; left time: 176.5237s
	iters: 300, epoch: 18 | loss: 0.1444102
	speed: 0.1144s/iter; left time: 160.0655s
	iters: 400, epoch: 18 | loss: 0.1600590
	speed: 0.1078s/iter; left time: 140.0020s
	iters: 500, epoch: 18 | loss: 0.1614382
	speed: 0.1077s/iter; left time: 129.1300s
Epoch: 18 cost time: 63.73126244544983
Epoch: 18, Steps: 566 | Train Loss: 0.1604527 Vali Loss: 0.1405291 Test Loss: 0.1663392
Validation loss decreased (0.141162 --> 0.140529).  Saving model ...
Updating learning rate to 0.0003799773172495354
	iters: 100, epoch: 19 | loss: 0.1659364
	speed: 0.2610s/iter; left time: 269.6156s
	iters: 200, epoch: 19 | loss: 0.1420383
	speed: 0.1087s/iter; left time: 101.4597s
	iters: 300, epoch: 19 | loss: 0.1649020
	speed: 0.1211s/iter; left time: 100.8688s
	iters: 400, epoch: 19 | loss: 0.1494201
	speed: 0.1176s/iter; left time: 86.2061s
	iters: 500, epoch: 19 | loss: 0.1486551
	speed: 0.1151s/iter; left time: 72.8628s
Epoch: 19 cost time: 64.55304193496704
Epoch: 19, Steps: 566 | Train Loss: 0.1599827 Vali Loss: 0.1405765 Test Loss: 0.1664486
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.577511882943689e-05
	iters: 100, epoch: 20 | loss: 0.1520081
	speed: 0.2743s/iter; left time: 128.0754s
	iters: 200, epoch: 20 | loss: 0.1622571
	speed: 0.1097s/iter; left time: 40.2564s
	iters: 300, epoch: 20 | loss: 0.1827153
	speed: 0.1213s/iter; left time: 32.3742s
	iters: 400, epoch: 20 | loss: 0.1510291
	speed: 0.1211s/iter; left time: 20.2283s
	iters: 500, epoch: 20 | loss: 0.1605242
	speed: 0.1208s/iter; left time: 8.0909s
Epoch: 20 cost time: 66.24076175689697
Epoch: 20, Steps: 566 | Train Loss: 0.1597157 Vali Loss: 0.1403982 Test Loss: 0.1664151
Validation loss decreased (0.140529 --> 0.140398).  Saving model ...
Updating learning rate to 4.030086050820826e-08
>>>>>>>testing : long_term_forecast_ECL_96_192_none_TimeMixer_custom_sl96_pl192_dm16_nh8_el3_dl1_df32_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 5069
mse:0.16641536355018616, mae:0.2567896544933319
Args in experiment:
Namespace(task_name='long_term_forecast', is_training=1, model_id='ECL_96_336', model='TimeMixer', data='custom', root_path='./dataset/electricity/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=0, pred_len=336, seasonal_patterns='Monthly', inverse=False, top_k=5, num_kernels=6, enc_in=321, dec_in=321, c_out=321, d_model=16, n_heads=8, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=3, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, channel_independence=1, decomp_method='moving_avg', use_norm=1, down_sampling_layers=3, down_sampling_window=2, down_sampling_method='avg', use_future_temporal_feature=0, mask_rate=0.125, anomaly_ratio=0.25, num_workers=10, itr=1, train_epochs=20, batch_size=32, patience=10, learning_rate=0.01, des='Exp', loss='MSE', drop_last=True, lradj='TST', pct_start=0.2, use_amp=False, comment='none', use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1', p_hidden_dims=[128, 128], p_hidden_layers=2)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_336_none_TimeMixer_custom_sl96_pl336_dm16_nh8_el3_dl1_df32_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17981
val 2297
test 4925
	iters: 100, epoch: 1 | loss: 0.4037566
	speed: 0.1379s/iter; left time: 1533.9822s
	iters: 200, epoch: 1 | loss: 0.3104718
	speed: 0.1248s/iter; left time: 1375.8172s
	iters: 300, epoch: 1 | loss: 0.2450805
	speed: 0.1248s/iter; left time: 1363.0362s
	iters: 400, epoch: 1 | loss: 0.2680990
	speed: 0.1247s/iter; left time: 1349.2171s
	iters: 500, epoch: 1 | loss: 0.2375041
	speed: 0.1180s/iter; left time: 1264.8126s
Epoch: 1 cost time: 69.38954877853394
Epoch: 1, Steps: 561 | Train Loss: 0.3654267 Vali Loss: 0.1961173 Test Loss: 0.2207974
Validation loss decreased (inf --> 0.196117).  Saving model ...
Updating learning rate to 0.0018070761245881257
	iters: 100, epoch: 2 | loss: 0.2080221
	speed: 0.2847s/iter; left time: 3006.3058s
	iters: 200, epoch: 2 | loss: 0.2160020
	speed: 0.1227s/iter; left time: 1283.7581s
	iters: 300, epoch: 2 | loss: 0.2169557
	speed: 0.1202s/iter; left time: 1245.3927s
	iters: 400, epoch: 2 | loss: 0.2235256
	speed: 0.1196s/iter; left time: 1227.3013s
	iters: 500, epoch: 2 | loss: 0.2234827
	speed: 0.1204s/iter; left time: 1222.9641s
Epoch: 2 cost time: 67.50646638870239
Epoch: 2, Steps: 561 | Train Loss: 0.2175421 Vali Loss: 0.1792469 Test Loss: 0.2038583
Validation loss decreased (0.196117 --> 0.179247).  Saving model ...
Updating learning rate to 0.005203361489858366
	iters: 100, epoch: 3 | loss: 0.2326302
	speed: 0.2829s/iter; left time: 2828.6315s
	iters: 200, epoch: 3 | loss: 0.2031952
	speed: 0.1250s/iter; left time: 1237.3757s
	iters: 300, epoch: 3 | loss: 0.1982434
	speed: 0.1249s/iter; left time: 1224.3443s
	iters: 400, epoch: 3 | loss: 0.2031415
	speed: 0.1250s/iter; left time: 1212.2145s
	iters: 500, epoch: 3 | loss: 0.2234343
	speed: 0.1250s/iter; left time: 1200.1935s
Epoch: 3 cost time: 68.92706990242004
Epoch: 3, Steps: 561 | Train Loss: 0.2051588 Vali Loss: 0.1705500 Test Loss: 0.1949852
Validation loss decreased (0.179247 --> 0.170550).  Saving model ...
Updating learning rate to 0.00859767607507746
	iters: 100, epoch: 4 | loss: 0.1916654
	speed: 0.2765s/iter; left time: 2609.9607s
	iters: 200, epoch: 4 | loss: 0.2042191
	speed: 0.1248s/iter; left time: 1165.4621s
	iters: 300, epoch: 4 | loss: 0.1972072
	speed: 0.1249s/iter; left time: 1153.6591s
	iters: 400, epoch: 4 | loss: 0.2117383
	speed: 0.1248s/iter; left time: 1140.2706s
	iters: 500, epoch: 4 | loss: 0.1933757
	speed: 0.1250s/iter; left time: 1129.4707s
Epoch: 4 cost time: 68.85540127754211
Epoch: 4, Steps: 561 | Train Loss: 0.1991395 Vali Loss: 0.1700034 Test Loss: 0.1967308
Validation loss decreased (0.170550 --> 0.170003).  Saving model ...
Updating learning rate to 0.00999999969375266
	iters: 100, epoch: 5 | loss: 0.2018899
	speed: 0.2810s/iter; left time: 2494.2102s
	iters: 200, epoch: 5 | loss: 0.2073448
	speed: 0.1218s/iter; left time: 1068.6173s
	iters: 300, epoch: 5 | loss: 0.2016343
	speed: 0.1226s/iter; left time: 1064.0056s
	iters: 400, epoch: 5 | loss: 0.1969376
	speed: 0.1200s/iter; left time: 1028.8459s
	iters: 500, epoch: 5 | loss: 0.2088120
	speed: 0.1200s/iter; left time: 1017.3953s
Epoch: 5 cost time: 67.36078071594238
Epoch: 5, Steps: 561 | Train Loss: 0.1960499 Vali Loss: 0.1683427 Test Loss: 0.1942082
Validation loss decreased (0.170003 --> 0.168343).  Saving model ...
Updating learning rate to 0.009903585080055092
	iters: 100, epoch: 6 | loss: 0.2199613
	speed: 0.2831s/iter; left time: 2354.6539s
	iters: 200, epoch: 6 | loss: 0.1789400
	speed: 0.1182s/iter; left time: 970.8224s
	iters: 300, epoch: 6 | loss: 0.1838584
	speed: 0.1251s/iter; left time: 1015.3317s
	iters: 400, epoch: 6 | loss: 0.2000857
	speed: 0.1251s/iter; left time: 1002.6836s
	iters: 500, epoch: 6 | loss: 0.1816605
	speed: 0.1249s/iter; left time: 988.5637s
Epoch: 6 cost time: 68.36865878105164
Epoch: 6, Steps: 561 | Train Loss: 0.1941918 Vali Loss: 0.1659830 Test Loss: 0.1900185
Validation loss decreased (0.168343 --> 0.165983).  Saving model ...
Updating learning rate to 0.009618729210281984
	iters: 100, epoch: 7 | loss: 0.1932913
	speed: 0.2874s/iter; left time: 2228.6469s
	iters: 200, epoch: 7 | loss: 0.1875158
	speed: 0.1135s/iter; left time: 869.1918s
	iters: 300, epoch: 7 | loss: 0.1971777
	speed: 0.1251s/iter; left time: 945.0976s
	iters: 400, epoch: 7 | loss: 0.1822729
	speed: 0.1249s/iter; left time: 931.1856s
	iters: 500, epoch: 7 | loss: 0.1993152
	speed: 0.1249s/iter; left time: 918.8783s
Epoch: 7 cost time: 67.89461851119995
Epoch: 7, Steps: 561 | Train Loss: 0.1931476 Vali Loss: 0.1645405 Test Loss: 0.1874588
Validation loss decreased (0.165983 --> 0.164540).  Saving model ...
Updating learning rate to 0.009156378935759704
	iters: 100, epoch: 8 | loss: 0.1772575
	speed: 0.2920s/iter; left time: 2100.8783s
	iters: 200, epoch: 8 | loss: 0.2011455
	speed: 0.1129s/iter; left time: 800.9076s
	iters: 300, epoch: 8 | loss: 0.1952014
	speed: 0.1211s/iter; left time: 847.2924s
	iters: 400, epoch: 8 | loss: 0.1986360
	speed: 0.1225s/iter; left time: 844.1942s
	iters: 500, epoch: 8 | loss: 0.1937657
	speed: 0.1175s/iter; left time: 798.1689s
Epoch: 8 cost time: 66.02743721008301
Epoch: 8, Steps: 561 | Train Loss: 0.1917319 Vali Loss: 0.1615670 Test Loss: 0.1883131
Validation loss decreased (0.164540 --> 0.161567).  Saving model ...
Updating learning rate to 0.008534302118249126
	iters: 100, epoch: 9 | loss: 0.1875325
	speed: 0.2899s/iter; left time: 1922.8101s
	iters: 200, epoch: 9 | loss: 0.1770799
	speed: 0.1130s/iter; left time: 738.1295s
	iters: 300, epoch: 9 | loss: 0.1694067
	speed: 0.1170s/iter; left time: 752.8284s
	iters: 400, epoch: 9 | loss: 0.2131499
	speed: 0.1250s/iter; left time: 791.9150s
	iters: 500, epoch: 9 | loss: 0.1596783
	speed: 0.1251s/iter; left time: 779.6107s
Epoch: 9 cost time: 67.36845183372498
Epoch: 9, Steps: 561 | Train Loss: 0.1905298 Vali Loss: 0.1634166 Test Loss: 0.1862530
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0077764048209824806
	iters: 100, epoch: 10 | loss: 0.1888314
	speed: 0.3000s/iter; left time: 1821.8134s
	iters: 200, epoch: 10 | loss: 0.1686149
	speed: 0.1135s/iter; left time: 677.8914s
	iters: 300, epoch: 10 | loss: 0.1855495
	speed: 0.1140s/iter; left time: 669.4560s
	iters: 400, epoch: 10 | loss: 0.1908514
	speed: 0.1254s/iter; left time: 724.0515s
	iters: 500, epoch: 10 | loss: 0.1857122
	speed: 0.1263s/iter; left time: 716.1963s
Epoch: 10 cost time: 67.82427978515625
Epoch: 10, Steps: 561 | Train Loss: 0.1896822 Vali Loss: 0.1623807 Test Loss: 0.1872983
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.006911812612060022
	iters: 100, epoch: 11 | loss: 0.1838210
	speed: 0.3074s/iter; left time: 1694.2780s
	iters: 200, epoch: 11 | loss: 0.1817674
	speed: 0.1145s/iter; left time: 619.7014s
	iters: 300, epoch: 11 | loss: 0.2040863
	speed: 0.1139s/iter; left time: 604.7285s
	iters: 400, epoch: 11 | loss: 0.1885672
	speed: 0.1207s/iter; left time: 628.9288s
	iters: 500, epoch: 11 | loss: 0.1842784
	speed: 0.1236s/iter; left time: 631.5272s
Epoch: 11 cost time: 67.09593963623047
Epoch: 11, Steps: 561 | Train Loss: 0.1882966 Vali Loss: 0.1612702 Test Loss: 0.1873250
Validation loss decreased (0.161567 --> 0.161270).  Saving model ...
Updating learning rate to 0.005973751285201747
	iters: 100, epoch: 12 | loss: 0.1787612
	speed: 0.2940s/iter; left time: 1455.3343s
	iters: 200, epoch: 12 | loss: 0.1745862
	speed: 0.1182s/iter; left time: 573.1275s
	iters: 300, epoch: 12 | loss: 0.1955138
	speed: 0.1141s/iter; left time: 542.0549s
	iters: 400, epoch: 12 | loss: 0.1843140
	speed: 0.1177s/iter; left time: 547.1968s
	iters: 500, epoch: 12 | loss: 0.1811789
	speed: 0.1261s/iter; left time: 573.9532s
Epoch: 12 cost time: 67.50438785552979
Epoch: 12, Steps: 561 | Train Loss: 0.1873422 Vali Loss: 0.1595344 Test Loss: 0.1864349
Validation loss decreased (0.161270 --> 0.159534).  Saving model ...
Updating learning rate to 0.004998270011127964
	iters: 100, epoch: 13 | loss: 0.1923181
	speed: 0.3084s/iter; left time: 1353.4891s
	iters: 200, epoch: 13 | loss: 0.2071218
	speed: 0.1229s/iter; left time: 527.1897s
	iters: 300, epoch: 13 | loss: 0.1833341
	speed: 0.1139s/iter; left time: 477.0303s
	iters: 400, epoch: 13 | loss: 0.1684631
	speed: 0.1140s/iter; left time: 465.9925s
	iters: 500, epoch: 13 | loss: 0.1902640
	speed: 0.1248s/iter; left time: 497.7462s
Epoch: 13 cost time: 67.93735361099243
Epoch: 13, Steps: 561 | Train Loss: 0.1861108 Vali Loss: 0.1596226 Test Loss: 0.1851741
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00402285598814513
	iters: 100, epoch: 14 | loss: 0.1767697
	speed: 0.3069s/iter; left time: 1174.9266s
	iters: 200, epoch: 14 | loss: 0.1875441
	speed: 0.1263s/iter; left time: 470.6783s
	iters: 300, epoch: 14 | loss: 0.1694474
	speed: 0.1153s/iter; left time: 418.3546s
	iters: 400, epoch: 14 | loss: 0.1926441
	speed: 0.1139s/iter; left time: 401.8725s
	iters: 500, epoch: 14 | loss: 0.1863037
	speed: 0.1200s/iter; left time: 411.3198s
Epoch: 14 cost time: 67.95406365394592
Epoch: 14, Steps: 561 | Train Loss: 0.1851355 Vali Loss: 0.1590074 Test Loss: 0.1845918
Validation loss decreased (0.159534 --> 0.159007).  Saving model ...
Updating learning rate to 0.0030849938301379855
	iters: 100, epoch: 15 | loss: 0.1717235
	speed: 0.2982s/iter; left time: 974.2966s
	iters: 200, epoch: 15 | loss: 0.1780634
	speed: 0.1191s/iter; left time: 377.2318s
	iters: 300, epoch: 15 | loss: 0.1690462
	speed: 0.1189s/iter; left time: 364.5520s
	iters: 400, epoch: 15 | loss: 0.1812996
	speed: 0.1140s/iter; left time: 338.2814s
	iters: 500, epoch: 15 | loss: 0.1721170
	speed: 0.1169s/iter; left time: 335.1771s
Epoch: 15 cost time: 66.68011403083801
Epoch: 15, Steps: 561 | Train Loss: 0.1838781 Vali Loss: 0.1595451 Test Loss: 0.1857350
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.0022207250538795907
	iters: 100, epoch: 16 | loss: 0.1706350
	speed: 0.3068s/iter; left time: 830.2953s
	iters: 200, epoch: 16 | loss: 0.1841052
	speed: 0.1262s/iter; left time: 328.8108s
	iters: 300, epoch: 16 | loss: 0.1762304
	speed: 0.1234s/iter; left time: 309.3391s
	iters: 400, epoch: 16 | loss: 0.1733311
	speed: 0.1139s/iter; left time: 274.0414s
	iters: 500, epoch: 16 | loss: 0.1750898
	speed: 0.1140s/iter; left time: 262.8303s
Epoch: 16 cost time: 67.91693687438965
Epoch: 16, Steps: 561 | Train Loss: 0.1830208 Vali Loss: 0.1592461 Test Loss: 0.1839942
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.0014632630237540385
	iters: 100, epoch: 17 | loss: 0.1844019
	speed: 0.3051s/iter; left time: 654.3992s
	iters: 200, epoch: 17 | loss: 0.1954249
	speed: 0.1264s/iter; left time: 258.4652s
	iters: 300, epoch: 17 | loss: 0.1605871
	speed: 0.1261s/iter; left time: 245.2891s
	iters: 400, epoch: 17 | loss: 0.1773884
	speed: 0.1161s/iter; left time: 214.2271s
	iters: 500, epoch: 17 | loss: 0.1879705
	speed: 0.1140s/iter; left time: 198.8545s
Epoch: 17 cost time: 68.00568866729736
Epoch: 17, Steps: 561 | Train Loss: 0.1819395 Vali Loss: 0.1580273 Test Loss: 0.1839007
Validation loss decreased (0.159007 --> 0.158027).  Saving model ...
Updating learning rate to 0.0008417165807894585
	iters: 100, epoch: 18 | loss: 0.1681779
	speed: 0.2965s/iter; left time: 469.6859s
	iters: 200, epoch: 18 | loss: 0.2107278
	speed: 0.1205s/iter; left time: 178.8524s
	iters: 300, epoch: 18 | loss: 0.1742812
	speed: 0.1202s/iter; left time: 166.3075s
	iters: 400, epoch: 18 | loss: 0.1789018
	speed: 0.1198s/iter; left time: 153.8245s
	iters: 500, epoch: 18 | loss: 0.1696912
	speed: 0.1139s/iter; left time: 134.8351s
Epoch: 18 cost time: 66.64787411689758
Epoch: 18, Steps: 561 | Train Loss: 0.1812417 Vali Loss: 0.1578766 Test Loss: 0.1846241
Validation loss decreased (0.158027 --> 0.157877).  Saving model ...
Updating learning rate to 0.0003799714062217135
	iters: 100, epoch: 19 | loss: 0.1830980
	speed: 0.2725s/iter; left time: 278.8058s
	iters: 200, epoch: 19 | loss: 0.1751164
	speed: 0.1249s/iter; left time: 115.3233s
	iters: 300, epoch: 19 | loss: 0.1641346
	speed: 0.1312s/iter; left time: 107.9984s
	iters: 400, epoch: 19 | loss: 0.1553493
	speed: 0.1320s/iter; left time: 95.4542s
	iters: 500, epoch: 19 | loss: 0.1712518
	speed: 0.1307s/iter; left time: 81.4157s
Epoch: 19 cost time: 70.09710144996643
Epoch: 19, Steps: 561 | Train Loss: 0.1807194 Vali Loss: 0.1579082 Test Loss: 0.1848426
EarlyStopping counter: 1 out of 10
Updating learning rate to 9.577210815976846e-05
	iters: 100, epoch: 20 | loss: 0.1849970
	speed: 0.2935s/iter; left time: 135.5956s
	iters: 200, epoch: 20 | loss: 0.1523474
	speed: 0.1320s/iter; left time: 47.8013s
	iters: 300, epoch: 20 | loss: 0.1638448
	speed: 0.1313s/iter; left time: 34.4033s
	iters: 400, epoch: 20 | loss: 0.1759853
	speed: 0.1310s/iter; left time: 21.2228s
	iters: 500, epoch: 20 | loss: 0.1863772
	speed: 0.1161s/iter; left time: 7.1981s
Epoch: 20 cost time: 70.99650645256042
Epoch: 20, Steps: 561 | Train Loss: 0.1803621 Vali Loss: 0.1577640 Test Loss: 0.1849600
Validation loss decreased (0.157877 --> 0.157764).  Saving model ...
Updating learning rate to 4.030624733984659e-08
>>>>>>>testing : long_term_forecast_ECL_96_336_none_TimeMixer_custom_sl96_pl336_dm16_nh8_el3_dl1_df32_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4925
mse:0.18495985865592957, mae:0.2748100459575653
Args in experiment:
Namespace(task_name='long_term_forecast', is_training=1, model_id='ECL_96_720', model='TimeMixer', data='custom', root_path='./dataset/electricity/', data_path='electricity.csv', features='M', target='OT', freq='h', checkpoints='./checkpoints/', seq_len=96, label_len=0, pred_len=720, seasonal_patterns='Monthly', inverse=False, top_k=5, num_kernels=6, enc_in=321, dec_in=321, c_out=321, d_model=16, n_heads=8, e_layers=3, d_layers=1, d_ff=32, moving_avg=25, factor=3, distil=True, dropout=0.1, embed='timeF', activation='gelu', output_attention=False, channel_independence=1, decomp_method='moving_avg', use_norm=1, down_sampling_layers=3, down_sampling_window=2, down_sampling_method='avg', use_future_temporal_feature=0, mask_rate=0.125, anomaly_ratio=0.25, num_workers=10, itr=1, train_epochs=20, batch_size=32, patience=10, learning_rate=0.01, des='Exp', loss='MSE', drop_last=True, lradj='TST', pct_start=0.2, use_amp=False, comment='none', use_gpu=True, gpu=0, use_multi_gpu=False, devices='0,1', p_hidden_dims=[128, 128], p_hidden_layers=2)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_ECL_96_720_none_TimeMixer_custom_sl96_pl720_dm16_nh8_el3_dl1_df32_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 17597
val 1913
test 4541
	iters: 100, epoch: 1 | loss: 0.4665503
	speed: 0.1559s/iter; left time: 1696.0901s
	iters: 200, epoch: 1 | loss: 0.3447122
	speed: 0.1386s/iter; left time: 1493.9488s
	iters: 300, epoch: 1 | loss: 0.3093345
	speed: 0.1559s/iter; left time: 1665.3169s
	iters: 400, epoch: 1 | loss: 0.3455476
	speed: 0.1574s/iter; left time: 1665.6093s
	iters: 500, epoch: 1 | loss: 0.2849147
	speed: 0.1573s/iter; left time: 1648.8383s
Epoch: 1 cost time: 82.7104856967926
Epoch: 1, Steps: 549 | Train Loss: 0.4390623 Vali Loss: 0.2334236 Test Loss: 0.2680165
Validation loss decreased (inf --> 0.233424).  Saving model ...
Updating learning rate to 0.0018071021230250985
	iters: 100, epoch: 2 | loss: 0.3244579
	speed: 0.3448s/iter; left time: 3562.4430s
	iters: 200, epoch: 2 | loss: 0.2668635
	speed: 0.1568s/iter; left time: 1604.0016s
	iters: 300, epoch: 2 | loss: 0.2871500
	speed: 0.1568s/iter; left time: 1589.1631s
	iters: 400, epoch: 2 | loss: 0.2629473
	speed: 0.1423s/iter; left time: 1427.3984s
	iters: 500, epoch: 2 | loss: 0.2460052
	speed: 0.1436s/iter; left time: 1425.9461s
Epoch: 2 cost time: 83.18038511276245
Epoch: 2, Steps: 549 | Train Loss: 0.2685721 Vali Loss: 0.2080587 Test Loss: 0.2444833
Validation loss decreased (0.233424 --> 0.208059).  Saving model ...
Updating learning rate to 0.0052034349985080035
	iters: 100, epoch: 3 | loss: 0.2549326
	speed: 0.3692s/iter; left time: 3611.4815s
	iters: 200, epoch: 3 | loss: 0.2524026
	speed: 0.1468s/iter; left time: 1421.2299s
	iters: 300, epoch: 3 | loss: 0.2446307
	speed: 0.1332s/iter; left time: 1276.1440s
	iters: 400, epoch: 3 | loss: 0.2442013
	speed: 0.1446s/iter; left time: 1371.2539s
	iters: 500, epoch: 3 | loss: 0.2660535
	speed: 0.1500s/iter; left time: 1407.8437s
Epoch: 3 cost time: 81.01086139678955
Epoch: 3, Steps: 549 | Train Loss: 0.2528459 Vali Loss: 0.2049019 Test Loss: 0.2366729
Validation loss decreased (0.208059 --> 0.204902).  Saving model ...
Updating learning rate to 0.008597753959952076
	iters: 100, epoch: 4 | loss: 0.2325154
	speed: 0.3442s/iter; left time: 3178.6956s
	iters: 200, epoch: 4 | loss: 0.2574846
	speed: 0.1523s/iter; left time: 1391.4950s
	iters: 300, epoch: 4 | loss: 0.2456813
	speed: 0.1574s/iter; left time: 1422.1975s
	iters: 400, epoch: 4 | loss: 0.2269199
	speed: 0.1569s/iter; left time: 1401.6100s
	iters: 500, epoch: 4 | loss: 0.2356775
	speed: 0.1457s/iter; left time: 1287.2888s
Epoch: 4 cost time: 82.01946496963501
Epoch: 4, Steps: 549 | Train Loss: 0.2462575 Vali Loss: 0.2028803 Test Loss: 0.2321520
Validation loss decreased (0.204902 --> 0.202880).  Saving model ...
Updating learning rate to 0.009999999680218483
	iters: 100, epoch: 5 | loss: 0.2605716
	speed: 0.3559s/iter; left time: 3090.5975s
	iters: 200, epoch: 5 | loss: 0.2260572
	speed: 0.1577s/iter; left time: 1353.7618s
	iters: 300, epoch: 5 | loss: 0.2245724
	speed: 0.1475s/iter; left time: 1251.6557s
	iters: 400, epoch: 5 | loss: 0.2198106
	speed: 0.1383s/iter; left time: 1160.0572s
	iters: 500, epoch: 5 | loss: 0.2557842
	speed: 0.1557s/iter; left time: 1290.2121s
Epoch: 5 cost time: 83.64200186729431
Epoch: 5, Steps: 549 | Train Loss: 0.2421772 Vali Loss: 0.2001509 Test Loss: 0.2297976
Validation loss decreased (0.202880 --> 0.200151).  Saving model ...
Updating learning rate to 0.009903577604357403
	iters: 100, epoch: 6 | loss: 0.2332619
	speed: 0.3494s/iter; left time: 2842.7689s
	iters: 200, epoch: 6 | loss: 0.2540393
	speed: 0.1309s/iter; left time: 1051.6326s
	iters: 300, epoch: 6 | loss: 0.2439052
	speed: 0.1499s/iter; left time: 1189.7319s
	iters: 400, epoch: 6 | loss: 0.2581715
	speed: 0.1583s/iter; left time: 1240.2120s
	iters: 500, epoch: 6 | loss: 0.2538272
	speed: 0.1568s/iter; left time: 1213.3103s
Epoch: 6 cost time: 81.33591604232788
Epoch: 6, Steps: 549 | Train Loss: 0.2398007 Vali Loss: 0.1962383 Test Loss: 0.2282529
Validation loss decreased (0.200151 --> 0.196238).  Saving model ...
Updating learning rate to 0.009618714559707654
	iters: 100, epoch: 7 | loss: 0.2377772
	speed: 0.3468s/iter; left time: 2631.2875s
	iters: 200, epoch: 7 | loss: 0.2338463
	speed: 0.1566s/iter; left time: 1172.5564s
	iters: 300, epoch: 7 | loss: 0.2049743
	speed: 0.1577s/iter; left time: 1165.0738s
	iters: 400, epoch: 7 | loss: 0.2248236
	speed: 0.1464s/iter; left time: 1066.7495s
	iters: 500, epoch: 7 | loss: 0.2376081
	speed: 0.1376s/iter; left time: 988.8224s
Epoch: 7 cost time: 82.5205945968628
Epoch: 7, Steps: 549 | Train Loss: 0.2373034 Vali Loss: 0.1978427 Test Loss: 0.2274306
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.00915635767332209
	iters: 100, epoch: 8 | loss: 0.2253273
	speed: 0.3667s/iter; left time: 2581.1757s
	iters: 200, epoch: 8 | loss: 0.2619927
	speed: 0.1521s/iter; left time: 1055.2540s
	iters: 300, epoch: 8 | loss: 0.2635235
	speed: 0.1383s/iter; left time: 945.7003s
	iters: 400, epoch: 8 | loss: 0.2255099
	speed: 0.1510s/iter; left time: 1017.4207s
	iters: 500, epoch: 8 | loss: 0.2354328
	speed: 0.1465s/iter; left time: 972.7067s
Epoch: 8 cost time: 81.81249237060547
Epoch: 8, Steps: 549 | Train Loss: 0.2358872 Vali Loss: 0.1964173 Test Loss: 0.2291217
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.008534275061051777
	iters: 100, epoch: 9 | loss: 0.2522673
	speed: 0.3275s/iter; left time: 2124.9082s
	iters: 200, epoch: 9 | loss: 0.2153090
	speed: 0.1457s/iter; left time: 930.7049s
	iters: 300, epoch: 9 | loss: 0.2118341
	speed: 0.1558s/iter; left time: 980.0676s
	iters: 400, epoch: 9 | loss: 0.2132141
	speed: 0.1557s/iter; left time: 963.8441s
	iters: 500, epoch: 9 | loss: 0.2354313
	speed: 0.1504s/iter; left time: 915.9171s
Epoch: 9 cost time: 81.56599760055542
Epoch: 9, Steps: 549 | Train Loss: 0.2337362 Vali Loss: 0.1982451 Test Loss: 0.2258442
EarlyStopping counter: 3 out of 10
Updating learning rate to 0.007776373008818319
	iters: 100, epoch: 10 | loss: 0.2197853
	speed: 0.3467s/iter; left time: 2059.2916s
	iters: 200, epoch: 10 | loss: 0.2149283
	speed: 0.1576s/iter; left time: 920.1912s
	iters: 300, epoch: 10 | loss: 0.2212416
	speed: 0.1542s/iter; left time: 884.9209s
	iters: 400, epoch: 10 | loss: 0.2155739
	speed: 0.1384s/iter; left time: 780.3781s
	iters: 500, epoch: 10 | loss: 0.2324793
	speed: 0.1492s/iter; left time: 826.4524s
Epoch: 10 cost time: 83.41354489326477
Epoch: 10, Steps: 549 | Train Loss: 0.2324363 Vali Loss: 0.1988934 Test Loss: 0.2334408
EarlyStopping counter: 4 out of 10
Updating learning rate to 0.006911777267452677
	iters: 100, epoch: 11 | loss: 0.2294260
	speed: 0.3674s/iter; left time: 1980.4929s
	iters: 200, epoch: 11 | loss: 0.2304891
	speed: 0.1348s/iter; left time: 713.2114s
	iters: 300, epoch: 11 | loss: 0.2365007
	speed: 0.1359s/iter; left time: 705.2607s
	iters: 400, epoch: 11 | loss: 0.2250446
	speed: 0.1477s/iter; left time: 752.0021s
	iters: 500, epoch: 11 | loss: 0.2442084
	speed: 0.1580s/iter; left time: 788.4888s
Epoch: 11 cost time: 81.19581532478333
Epoch: 11, Steps: 549 | Train Loss: 0.2307027 Vali Loss: 0.1932287 Test Loss: 0.2334278
Validation loss decreased (0.196238 --> 0.193229).  Saving model ...
Updating learning rate to 0.005973713766424657
	iters: 100, epoch: 12 | loss: 0.2236042
	speed: 0.3437s/iter; left time: 1664.2639s
	iters: 200, epoch: 12 | loss: 0.2415987
	speed: 0.1562s/iter; left time: 740.5924s
	iters: 300, epoch: 12 | loss: 0.2451006
	speed: 0.1568s/iter; left time: 727.6366s
	iters: 400, epoch: 12 | loss: 0.2460180
	speed: 0.1537s/iter; left time: 697.9056s
	iters: 500, epoch: 12 | loss: 0.2354748
	speed: 0.1379s/iter; left time: 612.5052s
Epoch: 12 cost time: 81.64666843414307
Epoch: 12, Steps: 549 | Train Loss: 0.2290790 Vali Loss: 0.1970988 Test Loss: 0.2270715
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.004998231760006692
	iters: 100, epoch: 13 | loss: 0.2116840
	speed: 0.3613s/iter; left time: 1551.1283s
	iters: 200, epoch: 13 | loss: 0.2153105
	speed: 0.1566s/iter; left time: 656.6813s
	iters: 300, epoch: 13 | loss: 0.2305383
	speed: 0.1393s/iter; left time: 570.2011s
	iters: 400, epoch: 13 | loss: 0.2421062
	speed: 0.1446s/iter; left time: 577.5122s
	iters: 500, epoch: 13 | loss: 0.2248145
	speed: 0.1575s/iter; left time: 612.9851s
Epoch: 13 cost time: 83.436518907547
Epoch: 13, Steps: 549 | Train Loss: 0.2276043 Vali Loss: 0.1989166 Test Loss: 0.2271382
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.0040228184746488125
	iters: 100, epoch: 14 | loss: 0.2187425
	speed: 0.3232s/iter; left time: 1210.0405s
	iters: 200, epoch: 14 | loss: 0.2434407
	speed: 0.1345s/iter; left time: 489.9667s
	iters: 300, epoch: 14 | loss: 0.2216790
	speed: 0.1562s/iter; left time: 553.5916s
	iters: 400, epoch: 14 | loss: 0.2144071
	speed: 0.1578s/iter; left time: 543.3840s
	iters: 500, epoch: 14 | loss: 0.2199861
	speed: 0.1564s/iter; left time: 523.1143s
Epoch: 14 cost time: 81.2153697013855
Epoch: 14, Steps: 549 | Train Loss: 0.2257359 Vali Loss: 0.1916803 Test Loss: 0.2242958
Validation loss decreased (0.193229 --> 0.191680).  Saving model ...
Updating learning rate to 0.003084958495889251
	iters: 100, epoch: 15 | loss: 0.1999723
	speed: 0.3447s/iter; left time: 1101.3640s
	iters: 200, epoch: 15 | loss: 0.2364588
	speed: 0.1569s/iter; left time: 485.4518s
	iters: 300, epoch: 15 | loss: 0.2168553
	speed: 0.1574s/iter; left time: 471.4414s
	iters: 400, epoch: 15 | loss: 0.2375521
	speed: 0.1427s/iter; left time: 413.0713s
	iters: 500, epoch: 15 | loss: 0.2134607
	speed: 0.1452s/iter; left time: 405.8494s
Epoch: 15 cost time: 83.42727279663086
Epoch: 15, Steps: 549 | Train Loss: 0.2239322 Vali Loss: 0.1961738 Test Loss: 0.2249775
EarlyStopping counter: 1 out of 10
Updating learning rate to 0.002220693256753801
	iters: 100, epoch: 16 | loss: 0.2326900
	speed: 0.3675s/iter; left time: 972.3912s
	iters: 200, epoch: 16 | loss: 0.1985888
	speed: 0.1457s/iter; left time: 370.8923s
	iters: 300, epoch: 16 | loss: 0.2240486
	speed: 0.1391s/iter; left time: 340.2886s
	iters: 400, epoch: 16 | loss: 0.2231425
	speed: 0.1490s/iter; left time: 349.6624s
	iters: 500, epoch: 16 | loss: 0.2177082
	speed: 0.1482s/iter; left time: 332.8696s
Epoch: 16 cost time: 81.20113587379456
Epoch: 16, Steps: 549 | Train Loss: 0.2222165 Vali Loss: 0.1925012 Test Loss: 0.2245148
EarlyStopping counter: 2 out of 10
Updating learning rate to 0.0014632359856969082
	iters: 100, epoch: 17 | loss: 0.2271936
	speed: 0.3394s/iter; left time: 711.6483s
	iters: 200, epoch: 17 | loss: 0.2311205
	speed: 0.1523s/iter; left time: 304.1172s
	iters: 300, epoch: 17 | loss: 0.2383362
	speed: 0.1559s/iter; left time: 295.7888s
	iters: 400, epoch: 17 | loss: 0.2247686
	speed: 0.1564s/iter; left time: 281.0266s
	iters: 500, epoch: 17 | loss: 0.2143304
	speed: 0.1433s/iter; left time: 243.1529s
Epoch: 17 cost time: 81.6539876461029
Epoch: 17, Steps: 549 | Train Loss: 0.2207981 Vali Loss: 0.1964850 Test Loss: 0.2242972
EarlyStopping counter: 3 out of 10
Updating learning rate to 0.0008416953408583565
	iters: 100, epoch: 18 | loss: 0.2161257
	speed: 0.3549s/iter; left time: 549.3473s
	iters: 200, epoch: 18 | loss: 0.2086902
	speed: 0.1578s/iter; left time: 228.4572s
	iters: 300, epoch: 18 | loss: 0.2224160
	speed: 0.1472s/iter; left time: 198.3619s
	iters: 400, epoch: 18 | loss: 0.2196536
	speed: 0.1375s/iter; left time: 171.6571s
	iters: 500, epoch: 18 | loss: 0.2446315
	speed: 0.1569s/iter; left time: 180.0829s
Epoch: 18 cost time: 83.39812994003296
Epoch: 18, Steps: 549 | Train Loss: 0.2196813 Vali Loss: 0.1956534 Test Loss: 0.2233892
EarlyStopping counter: 4 out of 10
Updating learning rate to 0.0003799567806552832
	iters: 100, epoch: 19 | loss: 0.2227586
	speed: 0.3599s/iter; left time: 359.5485s
	iters: 200, epoch: 19 | loss: 0.2443029
	speed: 0.1299s/iter; left time: 116.8221s
	iters: 300, epoch: 19 | loss: 0.2216736
	speed: 0.1407s/iter; left time: 112.4276s
	iters: 400, epoch: 19 | loss: 0.2149551
	speed: 0.1301s/iter; left time: 90.9647s
	iters: 500, epoch: 19 | loss: 0.2351381
	speed: 0.1361s/iter; left time: 81.5028s
Epoch: 19 cost time: 73.31427645683289
Epoch: 19, Steps: 549 | Train Loss: 0.2189222 Vali Loss: 0.1942045 Test Loss: 0.2255495
EarlyStopping counter: 5 out of 10
Updating learning rate to 9.576465901032395e-05
	iters: 100, epoch: 20 | loss: 0.2183344
	speed: 0.2941s/iter; left time: 132.3495s
	iters: 200, epoch: 20 | loss: 0.2237938
	speed: 0.1599s/iter; left time: 55.9523s
	iters: 300, epoch: 20 | loss: 0.2215610
	speed: 0.1597s/iter; left time: 39.9299s
	iters: 400, epoch: 20 | loss: 0.2189744
	speed: 0.1485s/iter; left time: 22.2784s
	iters: 500, epoch: 20 | loss: 0.2300892
	speed: 0.1421s/iter; left time: 7.1067s
Epoch: 20 cost time: 84.03724718093872
Epoch: 20, Steps: 549 | Train Loss: 0.2185034 Vali Loss: 0.1954039 Test Loss: 0.2251632
EarlyStopping counter: 6 out of 10
Updating learning rate to 4.031978151666785e-08
>>>>>>>testing : long_term_forecast_ECL_96_720_none_TimeMixer_custom_sl96_pl720_dm16_nh8_el3_dl1_df32_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 4541
mse:0.22429780662059784, mae:0.3122957944869995
